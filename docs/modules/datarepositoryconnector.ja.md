# データリポジトリコネクタ

[Data Repository Connectorモジュール](https://omeka.org/s/modules/DataRepositoryConnector/){target=_blank}は、Dataverse、Zenodo、Invenio、およびCKANなど、様々なデータリポジトリプラットフォームからの記録やデータファイルをインポートする機能をユーザーに提供します。一度インポートされると、これらのアイテムは「過去のインポート」ページからオリジナルのインポートを再実行していつでも更新することができます。

Data Repository Connectorは左側のモジュールメニューにエントリを追加します。モジュールの名前をクリックするか、左側のプラス記号アイコンをクリックすると、4つのインポートオプションへのリンクが表示されるメニューが展開されます。デフォルトでは、モジュールは「過去のインポート」ページを開きます。

![データリポジトリコネクタのオプションを示すナビゲーションメニュー](../modules/modulesfiles/datarepoconnect_tabs.png)

このモジュールは、グローバル管理者およびスーパーバイザーのユーザーが利用できます。

## データのインポート

### 共有オプション

選択したサービスに関係なく、以下のオプションが提供されます。

+ **Limit**: 単一バッチで取得する結果の最大数。エラーやデータが欠落していることに気づいた場合は、この数を小さくしてみてください。増やすとインポートが速くなる可能性があります。（このフィールドは必須です。デフォルトは100です。）
+ **テストインポート**: チェックされている場合、コネクターは上記Limitフィールドで示された数の結果のみをインポートします。これにより、ソースからOmeka Sへのメタデータマッピングをプレビューするだけでなく、接続が機能することを確認できます。
+ **Omeka Sにファイルをインポート**: チェックされている場合、レコードに関連するメディアがOmeka Sにインポートされます。そうでなければ、インポートにメディアは含まれません。
+ **コメント**: このインポートの目的やソースに関するメモ。これは「過去のインポート」ページに表示され、進捗状況の追跡に役立ちます。
+ **アイテムセット**: アイテムをインポートするアイテムセット。
+ **サイト**: アイテムをインポートするサイト。ここにデフォルトのサイトが表示される場合があります。

これらのフィールドを、選択したオプションに特有のフィールドと共に記入したら、「送信」をクリックします。

### Dataverse

![以下にリストされているオプションを表示するDataverseインポート画面](../modules/modulesfiles/datarepoconnect_options.png)

Dataverseを選択すると、以下のオプションが表示される画面が表示されます。

+ **Main Dataverse URL**: 主要なDataverseサイトのURL。（このフィールドは必須です。）
+ **Dataverse Identifier**: インポート元のDataverseの識別子。空欄の場合、**Main Dataverse URL**下のすべてのデータセットが大量にインポートされる可能性があります。
+ **メタデータフォーマット**: Dataverseからエクスポートするメタデータフォーマット。Dataverseのオプションは「dcterms」、「oai_dc」、「schema.org」です。このフォーマットは、インポートする前にOmekaインスタンス内に[vocabulary](../content/vocabularies.md)として存在している必要があり、それは[purl.org](http://purl.org/dc/elements/1.1/){target=_blank}および[schema.org](https://schema.org/docs/developers.html){target=_blank}から取得できます。（このフィールドは必須です。）

### Zenodo

Zenodoを選択すると、以下のオプションが表示される画面が表示されます。

+ **Zenodo Community ID**: インポートするZenodoコミュニティを識別する短い文字列。URL "https://zenodo.org/communities/" の後ろにあり、検索パラメータの前にあります。（このフィールドは必須です。）
+ **メタデータフォーマット**: Zenodoからエクスポートするメタデータフォーマット。Zenodoでの唯一のオプションは「oai_dc」です。このフォーマットは、インポートする前にOmekaインスタンス内に[vocabulary](../content/vocabularies.md)として存在している必要があり、それは[purl.org](http://purl.org/dc/elements/1.1/){target=_blank}から取得できます。（このフィールドは必須です。）

### Invenio

![Invenioインポート画面](../modules/modulesfiles/datarepoconnect_invenio.png)

Invenioを選択すると、以下のオプションが表示される画面が表示されます。

+ **Main Invenio URL**: 主要なInvenioサイトのURL。（このフィールドは必須です。）
+ **検索クエリ**: インポートされる結果を絞り込むための用語。空欄の場合、**Main Invenio URL**下のすべてのデータセットが大量にインポートされる可能性があります。[ElasticSearchクエリ構文](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-your-data.html){target=_blank}を使用することができます。例: "oceanography"、"access_right:open"。

### CKAN

CKANを選択すると、以下のオプションが表示される画面が表示されます。

+ **Main CKAN URL**: 主要なCKANサイトのURL。（このフィールドは必須です。）
+ **CKAN Organization**: インポートするCKAN組織の識別子。空欄の場合、**Main CKAN URL**下のすべてのデータセットが大量にインポートされる可能性があります。

### インポート状況の確認

「送信」をクリックした後、「過去のインポート」ページに移動し、最近のインポートジョブがページの上部の緑色のバーに表示されます。インポートの状況を追跡するには、「過去のインポート」ページをリロードするか、左側のナビゲーションのAdminセクションにあるJobsページをクリックします。

!!! 注
	ジョブが開始されても完了しない場合は、[PHPのパスを設定](../configuration.md#php-path)する必要があるかもしれません。これにより、システムがアイテムを作成するためのバックグラウンドプロセスを実行できます。

## インポートのレビュー

管理ダッシュボードの左側のナビゲーションでData Repository Connectorをクリックすると、「過去のインポート」ページが表示されます。

過去のインポートの表には次のものが含まれます。

- 過去のジョブを**やり直す**ための列と*取り消し**、
- インポートの**ジョブID**、
- 最初に提供された**データリポジトリ**へのリンク（使用した4つのソースのどれであったかを表示）、
- インポート中に行われた**コメント**、
- 影響を受けた**アイテム**の数（**追加された**ものと**更新された**ものに分けられている）、
- インポートの**日付**、
- インポートの**状態**、
- インポートを開始した**所有者**。

![データリポジトリコネクタからの過去のインポートを示す画面](../modules/modulesfiles/datarepoconnect_pastimports.png)

特定のインポートが取り消されたり、やり直されたりした場合、「状態」列がそれを示します。各ジョブから影響を受けたアイテムのサブセットを見るには、「アイテム」列の「合計」リンクをクリックします。

### インポートされたリソースを更新する

Data Repository Connectorを使用して作成したリソースを更新するには、単に同じソースからインポートを「やり直す」だけです。リソースは再インポートされずに更新されます。これにより、データリポジトリとOmeka Sインスタレーションとの間でデータを同期するためにコネクタを使用できます。

「過去のインポート」ページに移動します。 「やり直す」列の各インポートにチェックを入れてから、「送信」を押します。

!!! 注
	インポートをやり直すと、元のインポート以降にアイテムに加えたメタデータの変更が消えてしまいます。

### インポートを取り消す

完了したインポートをいつでも取り消して、関連するすべてのアイテムを削除することができます。これにより、それらのアイテムと行ったメタデータ編集が完全に消去されます。

「過去のインポート」ページに移動します。「取り消し」列の各インポートにチェックを入れ、その後「送信」をクリックします。