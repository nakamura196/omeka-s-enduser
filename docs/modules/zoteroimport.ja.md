# Zotero インポート

[Zotero インポート モジュール](https://omeka.org/s/modules/ZoteroImport){target=_blank} は、Omeka S インスタンスを Zotero ライブラリに接続し、そのライブラリからアイテムをインポートすることができます。

## お使いの Zotero ライブラリの準備
Zotero ライブラリからインポートするには、ライブラリへの API アクセスが必要です。Zotero インポートを使用するには、次のようにグループまたはユーザーの ID が必要です：

  * 個人の ID は、Zotero の設定の Feeds/API タブにあり、「API コールで使用するための userID」と記載されているセンテンスがあります。
  * グループ ID は、Zotero グループライブラリページの URL を見ることで見つけることができます - これは `zotero.org/groups/<number>` になります。`https://api.zotero.org/groups/<number>` にアクセスすると、そのページにいくつかの情報が表示されます。

特定のコレクションの ID とファイルをインポートするための API キーを持っていると便利かもしれません。

* コレクションキーはコレクションページの URL に表示されます - これは URL の末尾、“collections/”に続く英数字のシーケンスです。
* API キーを生成するには、Zotero アカウントで設定に行き、Feeds/API タブにアクセスし、*新しいプライベートキーを作成*リンクをクリックします。

## データのインポート

インポートするには、Omeka S の管理ダッシュボードの左側のナビゲーションにある Zotero インポートセクションへ行きます。これにより自動的に左側のナビゲーションにあるインポートサブセクションへ移動します。

![Zotero インポートオプション](modulesfiles/zoteroimport_new.png)

Zotero ライブラリからインポートするには：

* インポートしたアイテムが追加されるアイテムセットを選択します（必須）。
* **ユーザー** または **グループ** ライブラリのどちらかをラジオボタンで選択します（必須）。
* ライブラリ ID を入力します（これは上述のグループまたはユーザーID番号です）。
* コレクションをインポートする場合は、コレクションキーを入力します。
* 私用データやファイルをインポートするために、あなたの API キーを入力します（ファイルのインポートに必要ですが、インポート自体にはオプションです）。
* ファイルをインポートするためのチェックボックスをクリックします。ファイルをインポートするには API キーが必要です。
	* HTML ページのスナップショットは zip ファイルとしてインポートされます。
* "Added After" オプションを使用すると、選択した日時以降にライブラリに追加された Zotero アイテムのみをインポートすることができます。これを使用して、すでにインポートしたファイルを再度追加することなく、前回のインポートから更新することができます。

フォームの記入が完了したら、ブラウザウィンドウの右上隅にある "Submit" をクリックします。

!!! 注意
	ジョブが開始されても完了しない場合、システムがアイテムを作成するためのバックグラウンドプロセスを実行するために [PHP のパスを設定する](../configuration.md#php-path) 必要があるかもしれません。

ファイルに関する注記：アイテムをインポートするルールは Omeka でアイテムを作成するのと同じなので、Zotero ライブラリに許可されていないメディアタイプのファイルがある場合、アイテムはインポートされません。

ページは "Zotero からのインポート" メッセージとともに過去のインポートサブセクションにロードされます。インポートのステータスを確認するには、ページをリロードするか、[管理ダッシュボードのジョブセクション](../admin/jobs.md)をクリックします。

過去のインポートの管理
---------------------------------
過去のインポートを表示および管理するには、左側のナビゲーションにある Zotero インポートセクションをクリックし、メニューが展開されると表示される "Past Imports" サブセクションをクリックします。

過去のインポートページには、成功したもの、エラーで失敗したもの、または元に戻されたものがテーブルで表示されます。テーブルには以下のカラムがあります：

- **Zotero ライブラリ**：ユーザーまたはグループライブラリ名を示します。
- **元に戻す**ボタン：時計回りの曲がった矢印。
- **Items Added Before**：インポートの日付。
- **ジョブステータス**：ジョブの現在の状態。ジョブの状態のテキストをクリックすると、そのジョブのページに移動します。
- **アイテム数**：インポートの際に追加されたアイテムの数。

インポートを元に戻すには、**Items Added Before** タイムスタンプの左にある "Undo" ボタンをクリックします。これによりサイドバーダイアログが開き、インポートを元に戻してすべてのインポートされたアイテムを削除することを確認するよう求められます。続行するには "Confirm" をクリックします。

![サイドバーが開いて元に戻すことを確認する Past imports ページ](modulesfiles/zoteroimport_undo.png)

すでに元に戻された過去のインポートは "Undo Import Completed" というジョブの状態を持っているでしょう。