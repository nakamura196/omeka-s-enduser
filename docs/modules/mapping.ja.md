# マッピング

[マッピング・モジュール](https://omeka.org/s/modules/Mapping){target=_blank}を利用すると、Omeka Sのアイテムに地理的な位置情報を付加することができます。マップには、アイテムを時系列順に地図上でスクロール表示するためのタイムラインも含めることができます。

![タイムライン付きの地図](../modules/modulesfiles/mapping-timelinePublic1.png)

マッピング・モジュールには全体の設定はありません。各アイテムにいくつかの新しいメタデータフィールドを追加し、アイテムの編集画面に新しい「マッピング」タブを追加するだけでなく、アイテムの一括編集オプションもいくつか追加します。このモジュールは、管理者と公開インターフェースの高度な検索ページにオプションの地理位置に基づく検索フィールドを追加し、[サイト設定](../sites/site_settings.md#settings)によってサイトごとに管理されます。また、マップやタイムラインを表示して閲覧するためのページブロックを[サイトページ](../sites/site_pages.md)に追加し、[サイトナビゲーション設定](../sites/site_navigation.md)にある「マップ・ブラウズ」ページを追加します。

マッピングは[収集](../modules/collecting.md#prompts)モジュールと連動して動作し、投稿フォームに入力するユーザーが彼らの投稿に地理位置情報を提供することができます。ユーザーは地図上を直接クリックしてマーカーを配置し、オプションとしてマーカーにテキストラベルを提供することができます。詳細については収集モジュールのページを参照してください。

マッピングは[CSVインポート](../modules/csvimport.md)モジュールと連動して動作し、一括で地理位置情報を追加することができます。さらなる情報については、以下の[CSVインポート統合セクション](#csv-import-integration)を参照してください。

## マップの使用

マップの左側にある小さな白いボタンを使って、マップの外観を制御・変更することができます。マウスをボタンの上に置くと、ツールチップが表示されます。

![以下の記述に該当するマップのボタンのスクリーンショット](../modules/modulesfiles/Mapping_JustButtons.png)

* **拡大**: 小さい白い四角形に黒いプラス記号があります。クリックする度に1段階拡大します（0〜19の間）。
* **縮小**: 小さい白い四角形に黒いマイナス記号があります。クリックする度に1段階縮小します（0〜19の間）。
* **マーカーを描画**: 小さい白い四角形に黒いバブルマーカーがあります。このボタンをクリックすると、ポインターが青いマーカーになります。もう一度地図をクリックしてマーカーを配置します。
* **マーカーを移動**: 小さい白い四角形に黒いボックスと鉛筆のアイコンがあります。このオプションはマーカーが追加された後にのみ利用可能です。ボタンをクリックすると各マーカーの周りにピンクのボックスが表示されます。移動したいマーカーをクリックし、もう一度クリックして配置します。変更を「保存」または「キャンセル」するための灰色のボタンを使います。
* **マーカーを削除**: 小さい白いボタンにゴミ箱アイコンがあります。このオプションはマーカーが追加された後にのみ利用可能です。アイコンをクリックしてマーカーを選択します。削除するマーカーをクリックすると、マップから消えます。変更を「保存」または「キャンセル」するための灰色のボタンを使います。
* **アドレス検索**: 小さい白い四角形に黒い虫眼鏡アイコンがあります。クリックして検索バーにアドレスを入力します。
* **現在のビューをデフォルトビューとして設定**: 小さい白い四角形にターゲットまたはクロスヘアのシンボルがあります。マップはデフォルトでズームアウト（グローバルビュー）で表示されます。クリックして現在のビューをこのアイテムのデフォルトビューとして設定します。
* **現在のデフォルトビューに移動**: 小さい黒い四角形に黒いボックスがある点があります。このオプションはデフォルトビューを設定した後に利用可能です。選択したビューにマップをパンしてズームして移動します。
* **デフォルトの中心点とズームレベルをクリア**: 小さい白い四角形に黒い「X」があります。このオプションはデフォルトビューを設定した後に利用可能です。パンやズームの設定をクリアして、初期のグローバルビューに戻ります。

これらのオプションに加えて、マウスやトラックパッドを利用してズームしてパンすることもできます。また、マウスホイールを使用してスクロールしてズームする設定は、マップページブロックでオンまたはオフにすることができます。

## アイテムのマッピング

マッピング・モジュールは、各アイテムにメタデータ・フィールドを追加します：地図上にマーカーを作成する緯度と経度のペア（アイテムは複数のマーカーを持つことができます）、およびアイテムの個々のマップのデフォルト表示設定 - マップが少なくともトップ、ボトム、左右の位置を含むようにする最低限のコーナー座標です。これらはアイテムの「マッピング」タブを使って手動で設定することも、CSVインポートを使って多くのアイテムに一括で追加することもできます。

### マーカーの追加

アイテムの表示画面には、地理位置のメタデータがない限り「マッピング」タブは表示されませんが、編集時には表示されるようになります。アイテムにマップを追加するには、アイテムの編集画面で「マッピング」タブに移動して、アイテムに位置データを追加します。「マッピング」タブを選択するとマップインターフェースが開きます。

![「マッピング」タブが選択されたアイテムの追加/編集ページのスクリーンショット。大きな世界地図に下記の説明する白いボタンが表示されている](../modules/modulesfiles/Mapping_Item_Add.png)

マーカーを配置したいポイントを見つけるには、以下のいずれかの方法を使用できます：

* ズームしてドラッグして場所を探す。
* (下記の図４に示す)検索アドレスフィールドに地名を入力します。
  * この検索機能のフォーマットに一致しない位置は検索されないことに注意してください。
* 検索ボックスに緯度・経度の座標を入力します。これは例えば`38.897222, -77.064167`のような小数としてフォーマットされるべきです。`38° 53′ 50″ N, 77° 3′ 51″ W`といったフォーマットではありません。

![「ルーズベルト島」という検索語が入力され、その下に提案される一連の位置が表示されたマッピングタブ](../modules/modulesfiles/Mapping_itemSearch.png)

左ツールバーの**マーカーを描画**ツールをクリックします。カーソルが地図上を動かせるマーカーになります。地図をクリックしてポイントを設定します。

![アクティブなマーカーが引かれているマッピングタブ。マーカーには「クリックしてマーカーを設置」というツールチップが表示されている](../modules/modulesfiles/Mapping-drawMarker.png)

#### マーカーの編集

これで、マーカーをクリックして[label], which will display on [public map views](#public-view) of the item.
[selected items]の[public map views](#public-view)で表示されるラベルを追加することができます。このラベルは大きなフォントで表示されることに注意してください。

![拡大したマップに選択されたマーカーが表示され、そのラベルを入力する欄がある](../modules/modulesfiles/Mapping-addLabel.png)

ラベルを追加中には、[public view](#public-view)でクリック時にマーカーに表示される画像も追加できます。選択できる画像は、アイテムに[メディアとして既に添付された](../content/items.md#media)画像のみです。画像を削除するにはサイドバーで「画像なし」を選択します。

![画像が追加されたマーカーを選択。サイドバーにはメディアが表示され、その下に「画像なし」というオプションがある](../modules/modulesfiles/Mapping-addImage.png)

ラベルや画像を再編集するには、マーカーをクリックします。これで上に見たラベルと画像のオプションが開きます。

追加したマーカーを**移動する**には、左ツールバーの「マーカーを移動」ボタン（小さい白い四角形に黒いボックスと鉛筆アイコン）を使用します。地図上の任意のマーカーが赤い点線のアウトラインで強調表示されます。移動したいマーカーをクリックしてドラッグします。

変更を適用するには、「マーカーを移動」ボタンから開く「保存」オプションをクリックします。保存しなければ、マーカーは移動されません。

![移動されるマーカー](../modules/modulesfiles/Mapping-moveMarker.png)

マーカーを**削除する**には、最初に左ツールバーの「マーカーを削除」ボタン（ゴミ箱アイコン）をクリックします。削除したいマーカーをクリックすると、マップに配置されたマーカーが削除されます。削除を永続的にするためには、「マーカーを削除」ボタンから開くメニューで「保存」をクリックする必要があります。

「マーカーを削除」ボタンから開くメニュー内の「すべてクリア」ボタンを使って、マップ上のすべてのマーカーを一度にクリアすることもできます。

![削除されるマーカー](../modules/modulesfiles/Mapping-deleteMarker.png)

#### マップ表示

また、配置したマーカーとは独立して、マップのデフォルト表示のズームレベルと中心点を設定することもできます。デフォルトでは、1つのマーカーに中心点を置いて完全にズームインするか、すべてのマーカーをマップビューに含むだけの距離までズームアウトします。

* **現在のビューをデフォルトビューとして設定**: 小さい白い四角形にターゲットまたはクロスヘアのシンボルがある。マップはデフォルトでズームアウト（グローバルビュー）されます。クリックして現在のビューをこのアイテムのデフォルトビューとして設定します。
* **現在のデフォルトビューに移動**: 小さい黒い四角形に黒いボックスに点がある。このオプションはデフォルトビューを設定した後でのみ使用可能。クリックして選択したビューにマップをパンしてズームします。
* **デフォルトの中心点とズームレベルをクリア**: 小さい白い四角形に黒い「X」がある。このオプションはデフォルトビューを設定した後にのみ使用可能。クリックしてパンとズームの設定をクリアして初期のグローバルビューに戻ります。

### マップデータの検索

マーキングメタデータフィールドに情報が入力されているアイテム（マップ上にマーカーがあるアイテム）は、管理者および公開ビューの高度な検索フィールドにマッピングモジュールが追加したフィールドを使って検索できます。

![管理者側でのマップベースの検索](modulesfiles/Mapping_advSearch.png)

公開フィールドは[個々のサイト](../sites/site_settings.md#settings)でオプションになっており（デフォルトでは無効）、"地理的位置情報を高度な検索に追加"を設定することで、ユーザ